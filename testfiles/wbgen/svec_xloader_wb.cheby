memory-map:
  name: sxldr
  comment: SVEC FPGA loader
  description: A very simple serial firmware loader for Xilinx FPGAs. Programs the FPGA using serial slave mode method
  bus: wb-32-be
  x-wbgen:
    hdl_entity: svec_xloader_wb
  schema-version:
    core: 2.0.0
    x-conversions: 1.0.0
    x-driver-edge: 1.0.0
    x-enums: 1.0.0
    x-fesa: 2.0.0
    x-gena: 2.0.0
    x-hdl: 1.0.0
    x-map-info: 1.0.0
    x-wbgen: 1.0.0
  children:
  - reg:
      name: CSR
      comment: Control/status register
      width: 32
      access: rw
      address: 0x0
      children:
      - field:
          name: START
          comment: Start configuration
          description: 'write 1: starts the configuration process.\n         write 0: no effect'
          range: 0
          x-wbgen:
            type: MONOSTABLE
      - field:
          name: DONE
          comment: Configuration done
          description: 'read 1: the bitstream has been loaded\n         read 0: configuration still in progress'
          range: 1
          x-wbgen:
            access_bus: READ_ONLY
            access_dev: WRITE_ONLY
            type: BIT
      - field:
          name: ERROR
          comment: Configuration error
          description: 'read 1: an error occured during the configuration (DONE/INIT_B timeout)\n         read 0: configuration was successful'
          range: 2
          x-wbgen:
            access_bus: READ_ONLY
            access_dev: WRITE_ONLY
            type: BIT
      - field:
          name: BUSY
          comment: Loader busy
          description: 'read 1: the loader is busy (can''t start configuration yet)\n         read 0: the loader is ready to re-configure the FPGA'
          range: 3
          x-wbgen:
            access_bus: READ_ONLY
            access_dev: WRITE_ONLY
            type: BIT
      - field:
          name: MSBF
          comment: Byte order select
          description: 'write 1: MSB first (big endian host)\n         write 0: LSB first (little endian host)'
          range: 4
          x-wbgen:
            access_bus: READ_WRITE
            access_dev: READ_ONLY
            type: BIT
      - field:
          name: SWRST
          comment: Software resest
          description: 'write 1: resets the loader core\n         write 0: no effect'
          range: 5
          x-wbgen:
            type: MONOSTABLE
      - field:
          name: EXIT
          comment: Exit bootloader mode
          description: 'write 1: terminate bootloader mode and go passive (VME only)'
          range: 6
          x-wbgen:
            type: MONOSTABLE
      - field:
          name: CLKDIV
          comment: Serial clock divider
          description: CCLK division ratio. CCLK frequency = F_sysclk / 2 / (CLKDIV + 1)
          range: 13-8
          x-wbgen:
            access_bus: READ_WRITE
            access_dev: READ_ONLY
            type: SLV
      - field:
          name: VERSION
          comment: Bootloader version
          range: 21-14
          preset: 0x3
          x-wbgen:
            type: CONSTANT
  - reg:
      name: BTRIGR
      comment: Bootloader Trigger Register
      width: 32
      access: wo
      address: 0x4
      x-hdl:
        write-strobe: True
      children:
      - field:
          name: value
          comment: Trigger Sequence Input
          description: Write a sequence of 0xde, 0xad, 0xbe, 0xef, 0xca, 0xfe, 0xba, 0xbe to enter bootloader mode (VME only)
          range: 7-0
          x-wbgen:
            field_comment: Trigger Sequence Input
            field_description: Write a sequence of 0xde, 0xad, 0xbe, 0xef, 0xca, 0xfe, 0xba, 0xbe to enter bootloader mode (VME only)
            type: PASS_THROUGH
          x-hdl:
            type: wire
  - reg:
      name: FAR
      comment: Flash Access Register
      description: Provides direct access to the SPI flash memory containing the bitstream.
      width: 32
      access: rw
      address: 0x8
      x-hdl:
        write-strobe: True
      children:
      - field:
          name: DATA
          comment: SPI Data
          description: Data to be written / read to/from the flash SPI controller.
          range: 7-0
          x-wbgen:
            access_bus: READ_WRITE
            access_dev: READ_WRITE
            load: LOAD_EXT
            type: SLV
      - field:
          name: XFER
          comment: SPI Start Transfer
          description: 'write 1: initiate an SPI transfer with an 8-bit data word taken from the <code>DATA</code>field\n         write 0: no effect'
          range: 8
          x-wbgen:
            access_bus: READ_WRITE
            access_dev: READ_ONLY
            type: BIT
      - field:
          name: READY
          comment: SPI Ready
          description: 'read 1: Core is ready to initiate another transfer. DATA field contains the data read during previous transaction.\nread 0: core is busy'
          range: 9
          x-wbgen:
            access_bus: READ_ONLY
            access_dev: WRITE_ONLY
            type: BIT
      - field:
          name: CS
          comment: SPI Chip Select
          description: 'write 1: Enable target SPI controller\nwrite 0: Disable target SPI controller'
          range: 10
          x-wbgen:
            access_bus: READ_WRITE
            access_dev: READ_ONLY
            type: BIT
  - reg:
      name: IDR
      comment: ID Register
      description: User-defined identification code (g_idr_value generic)
      width: 32
      access: ro
      address: 0xc
      x-wbgen:
        access_bus: READ_ONLY
        access_dev: WRITE_ONLY
        field_comment: Identification code
        field_description: User-defined identification code (g_idr_value generic)
        type: SLV
  - block:
      name: FIFO
      comment: Bitstream FIFO
      address: 0x10
      align: False
      size: 12
      x-wbgen:
        depth: 256
        direction: BUS_TO_CORE
        kind: fifo
        wire_empty: True
        wire_full: True
      children:
      - reg:
          name: FIFO_r0
          comment: 'FIFO ''Bitstream FIFO'' data input register 0'
          width: 32
          access: wo
          address: 0x0
          children:
          - field:
              name: XSIZE
              comment: Entry size
              description: Number of bytes to send (0 = 1 byte .. 3 = full 32-bit word)
              range: 1-0
              x-wbgen:
                type: SLV
          - field:
              name: XLAST
              comment: Last xfer
              description: 'write 1: indicates the last word to be written to the FPGA'
              range: 2
              x-wbgen:
                type: BIT
      - reg:
          name: FIFO_r1
          comment: 'FIFO ''Bitstream FIFO'' data input register 1'
          width: 32
          access: wo
          address: 0x4
          children:
          - field:
              name: XDATA
              comment: Data
              description: Subsequent words of the bitstream
              range: 31-0
              x-wbgen:
                type: SLV
      - reg:
          name: FIFO_csr
          comment: 'FIFO ''Bitstream FIFO'' control/status register'
          width: 32
          access: rw
          address: 0x8
          x-wbgen:
            kind: fifocs
          children:
          - field:
              name: full
              comment: FIFO full flag
              description: '1: FIFO ''Bitstream FIFO'' is full\n0: FIFO is not full'
              range: 16
              x-wbgen:
                kind: full
                type: BIT
          - field:
              name: empty
              comment: FIFO empty flag
              description: '1: FIFO ''Bitstream FIFO'' is empty\n0: FIFO is not empty'
              range: 17
              x-wbgen:
                kind: empty
                type: BIT
          - field:
              name: clear_bus
              comment: FIFO clear
              description: 'write 1: clears FIFO ''Bitstream FIFO\nwrite 0: no effect'
              range: 18
              x-wbgen:
                kind: clear_bus
                type: BIT
          - field:
              name: count
              comment: FIFO counter
              description: 'Number of data records currently being stored in FIFO ''Bitstream FIFO'''
              range: 7-0
              x-wbgen:
                kind: count
